# File-by-File Reference

This maps each project file to its role in the pipeline.

## Root Files

`README.md`
- Top-level project guide and navigation.

`.gitignore`
- Excludes caches, virtual environments, artifacts (`models/`, `runs/`, etc.).

`requirements.txt`
- Dependency manifest only (installation is intentionally deferred).

## Configuration

`configs/microgrid.yaml`
- Environment, battery, grid, and reward parameters.
- Governs simulation dynamics and cost weighting.

`configs/training.yaml`
- RL training hyperparameters and output locations.

`configs/data_splits.yaml`
- Central mapping for `train`/`val`/`test` profile CSV paths.

## Data

`data/README.md`
- Notes for data folder usage.

`data/raw/.gitkeep`
- Placeholder to keep empty raw-data directory tracked.

`data/processed/.gitkeep`
- Placeholder for processed feature outputs.

`data/templates/profiles_template.csv`
- Example schema for renewable/load/price profile data.

## Source Package

`src/__init__.py`
- Marks `src` as package.

`src/config.py`
- Dataclasses for configs and YAML loading helpers.
- Includes split-path resolver used by train/eval scripts.

`src/main.py`
- Simple run path executing one random-policy episode with safety supervisor.

### Agents

`src/agents/__init__.py`
- Agents package marker.

`src/agents/trainer.py`
- RL training entrypoint and algorithm selection (`SAC`, `DDPG`).

### Data Utilities

`src/data/__init__.py`
- Data package marker.

`src/data/profiles.py`
- Loads real CSV profiles or generates synthetic fallback profiles.

`src/data/validation.py`
- CSV schema, quality, and time-continuity validation utilities.

`src/data/splitting.py`
- Chronological train/val/test splitting helpers.

### Environment

`src/envs/__init__.py`
- Environments package marker.

`src/envs/microgrid_env.py`
- Core Gymnasium environment:
  - state construction,
  - action handling,
  - battery constraints,
  - reward and info computation,
  - episode transitions.

### Controllers

`src/controllers/__init__.py`
- Controllers package marker.

`src/controllers/rule_based.py`
- Rule-based baseline controller for benchmark comparison.

### Safety

`src/safety/__init__.py`
- Safety package marker.

`src/safety/supervisor.py`
- Hard safety projection layer for SoC/temperature and power bounds.

### Integration

`src/integration/__init__.py`
- Integration package marker.

`src/integration/modbus_interface.py`
- Modbus TCP adapter scaffold for dispatching setpoints to external equipment.

### Evaluation

`src/evaluation/__init__.py`
- Evaluation package marker.

`src/evaluation/runner.py`
- Rollout runner and metrics aggregator for random/baseline/RL policies.

`src/evaluation/comparison.py`
- Baseline-vs-candidate comparison report with directional improvement metrics.

## Scripts

`scripts/__init__.py`
- Scripts package marker.

`scripts/train_rl.py`
- CLI entrypoint to start RL training.

`scripts/run_random_policy.py`
- CLI entrypoint to run random policy with safety layer as quick sanity check.

`scripts/validate_profiles.py`
- CLI tool to validate profile CSV quality and schema.

`scripts/split_profiles.py`
- CLI tool to create chronological train/val/test profile splits.

`scripts/evaluate_policy.py`
- CLI tool to evaluate random, baseline, or trained RL policies.

`scripts/benchmark_policies.py`
- CLI tool to compare random, baseline, and optional RL policy in one report.

`scripts/compare_baseline_vs_rl.py`
- CLI tool that evaluates baseline vs trained RL and writes JSON/Markdown delta reports.

## Tests

`tests/test_env_smoke.py`
- Smoke test validating environment reset/step loop and output shapes/types.

`tests/test_data_validation.py`
- Validation checks for profile schema and data constraints.

`tests/test_data_splitting.py`
- Split logic checks for expected partition sizes.

`tests/test_rule_based_controller.py`
- Baseline controller action and behavior checks.

`tests/test_evaluation_smoke.py`
- End-to-end evaluation smoke test.

`tests/test_profiles_loader.py`
- Confirms export price derivation path when CSV omits `price_export_per_kwh`.

`tests/test_config_splits.py`
- Verifies split config loading and profile path resolution precedence.

`tests/test_evaluation_comparison.py`
- Verifies direction-aware delta logic in baseline-vs-RL comparison.

## Documentation

`docs/README.md`
- Documentation index.

`docs/pipeline.md`
- End-to-end flow from data to control dispatch.

`docs/math.md`
- Mathematical formulation and equations used by current implementation.

`docs/design_choices.md`
- Engineering rationale and tradeoffs behind architecture and hyperparameters.

## Auto-Generated Runtime Caches

`__pycache__/...`
- Generated by Python compile/import.
- Not part of source design.
- Ignored by `.gitignore`.
